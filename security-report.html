<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Audit Report - Protected</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #333;
        }
        
        #loginModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-box h2 {
            color: #1a1a2e;
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .login-box .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .lock-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #4a90d9;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-bottom: 20px;
            display: none;
        }
        
        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        #reportContent {
            display: none;
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .report-header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .report-header h1 {
            color: #1a1a2e;
            margin-bottom: 15px;
        }
        
        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-right: 5px;
        }
        
        .badge-critical {
            background: #fee;
            color: #c33;
        }
        
        .badge-high {
            background: #ffeaa7;
            color: #d63031;
        }
        
        .badge-medium {
            background: #dfe6e9;
            color: #636e72;
        }
        
        .badge-p0 {
            background: #e74c3c;
            color: white;
        }
        
        .badge-p1 {
            background: #e67e22;
            color: white;
        }
        
        .badge-p2 {
            background: #f1c40f;
            color: #333;
        }
        
        .badge-p3 {
            background: #95a5a6;
            color: white;
        }
        
        .section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #1a1a2e;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .section h3 {
            color: #333;
            margin: 25px 0 15px;
            font-size: 1.3em;
        }
        
        .section h4 {
            color: #555;
            margin: 20px 0 10px;
            font-size: 1.1em;
        }
        
        .section p, .section li {
            line-height: 1.7;
            color: #555;
            margin-bottom: 12px;
        }
        
        .section ul, .section ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        
        .vuln-box {
            border-left: 4px solid;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .vuln-box.critical {
            border-left-color: #e74c3c;
            background: #fdf2f2;
        }
        
        .vuln-box.high {
            border-left-color: #e67e22;
            background: #fef5e7;
        }
        
        .vuln-box.medium {
            border-left-color: #f1c40f;
            background: #fefcf3;
        }
        
        .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .vuln-header h3 {
            margin: 0;
            flex: 1;
        }
        
        .vuln-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 13px;
            margin: 15px 0;
            line-height: 1.5;
        }
        
        .code-block .comment {
            color: #75715e;
        }
        
        .code-block .string {
            color: #e6db74;
        }
        
        .code-block .keyword {
            color: #66d9ef;
        }
        
        .meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .meta-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        
        .meta-item strong {
            display: block;
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .meta-item span {
            color: #333;
            font-weight: 600;
        }
        
        .logout-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            z-index: 100;
            width: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .impact-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .impact-box h4 {
            color: #856404;
            margin-top: 0;
        }
        
        .impact-box ul {
            margin-bottom: 0;
        }
        
        .remediation-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .remediation-box h4 {
            color: #155724;
            margin-top: 0;
        }
        
        .endpoint-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .endpoint-list code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .priority-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .priority-section h3 {
            color: white;
            margin-top: 0;
        }
        
        .priority-section ol {
            margin-left: 25px;
        }
        
        .priority-section li {
            color: white;
            margin-bottom: 8px;
        }
        
        .footer {
            text-align: center;
            padding: 40px;
            color: #1a1a2e;
            font-size: 14px;
            background: #f5f7fa;
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-card.critical {
            background: #fee;
        }
        
        .stat-card.high {
            background: #fef5e7;
        }
        
        .stat-card.medium {
            background: #fefcf3;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-card.critical .stat-number {
            color: #e74c3c;
        }
        
        .stat-card.high .stat-number {
            color: #e67e22;
        }
        
        .stat-card.medium .stat-number {
            color: #f1c40f;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .methodology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .methodology-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        
        .methodology-card h4 {
            margin-top: 0;
            color: #333;
        }
        
        .methodology-card ul {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div id="loginModal">
        <div class="login-box">
            <div class="lock-icon">üîí</div>
            <h2>Security Audit Report</h2>
            <p class="subtitle">Protected Document - Authentication Required</p>
            
            <div class="error-message" id="errorMsg">
                ‚ö†Ô∏è Invalid credentials. Please try again.
            </div>
            
            <div class="input-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter username" autocomplete="off">
            </div>
            
            <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter password">
            </div>
            
            <button onclick="login()">Access Report</button>
        </div>
    </div>
    
    <!-- Report Content -->
    <div id="reportContent">
        <button class="logout-btn" onclick="logout()">Logout</button>
        
        <div class="report-header">
            <h1>üî¥ Security Audit Report - Infinite Electronics</h1>
            <div class="meta-info">
                <div class="meta-item">
                    <strong>Target URL</strong>
                    <span>https://lcom-nextjsapp.happymeadow-56d1104c.centralus.azurecontainerapps.io/</span>
                </div>
                <div class="meta-item">
                    <strong>Date</strong>
                    <span>February 5, 2026</span>
                </div>
                <div class="meta-item">
                    <strong>Auditor</strong>
                    <span>Clawd</span>
                </div>
                <div class="meta-item">
                    <strong>Type</strong>
                    <span>Offensive Security Assessment</span>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üî¥ Executive Summary</h2>
            <p>A comprehensive security audit was conducted on the Infinite Electronics website. <strong>7 security vulnerabilities</strong> were discovered of varying severities:</p>
            
            <div class="summary-stats">
                <div class="stat-card critical">
                    <div class="stat-number">2</div>
                    <div class="stat-label">CRITICAL</div>
                </div>
                <div class="stat-card high">
                    <div class="stat-number">3</div>
                    <div class="stat-label">HIGH</div>
                </div>
                <div class="stat-card medium">
                    <div class="stat-number">2</div>
                    <div class="stat-label">MEDIUM</div>
                </div>
            </div>
            
            <div class="impact-box">
                <h4>‚ö†Ô∏è Key Findings</h4>
                <ul>
                    <li><strong>Massive data exposure:</strong> API leaks ProductCost, StockQuantity, WarehouseId</li>
                    <li><strong>IDOR vulnerability:</strong> Sequential ID access allows complete database scraping</li>
                    <li><strong>Reflected XSS:</strong> Search parameter vulnerable to script injection</li>
                    <li><strong>No rate limiting:</strong> Unlimited requests from single IP</li>
                    <li><strong>Missing security headers:</strong> No protection against common attacks</li>
                </ul>
            </div>
            
            <p><strong>Recommendation:</strong> The site requires immediate attention before production deployment. Critical vulnerabilities expose sensitive business data and allow complete system enumeration.</p>
        </div>
        
        <div class="section">
            <h2>üî¥ CRITICAL Vulnerabilities</h2>
            
            <div class="vuln-box critical">
                <div class="vuln-header">
                    <h3>SEC-001: Massive Database Data Exposure</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-critical">CRITICAL</span>
                        <span class="badge badge-p0">P0</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 7.5 (High) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>API endpoints expose the complete internal database structure, including commercially sensitive fields that should never be public.</p>
                
                <div class="endpoint-list">
                    <strong>Affected Endpoints:</strong>
                    <ul>
                        <li><code>GET /api/products?page=X&limit=Y</code></li>
                        <li><code>GET /api/products/{id}</code></li>
                    </ul>
                </div>
                
                <h4>Exposed Sensitive Data</h4>
                <div class="code-block">{
  <span class="string">"ProductCost"</span>: <span class="string">"0"</span>,              <span class="comment">// üí∞ Internal cost (profit margin)</span>
  <span class="string">"StockQuantity"</span>: 8,              <span class="comment">// üì¶ Real-time exact inventory</span>
  <span class="string">"WarehouseId"</span>: 26,               <span class="comment">// üè≠ Logistics infrastructure</span>
  <span class="string">"VendorId"</span>: 0,                   <span class="comment">// üè¢ Internal suppliers</span>
  <span class="string">"AdminComment"</span>: null,            <span class="comment">// üìù Administrative notes</span>
  <span class="string">"TaxCategoryId"</span>: 0,              <span class="comment">// üí∏ Tax classification</span>
  <span class="string">"ManageInventoryMethodId"</span>: 1,    <span class="comment">// ‚öôÔ∏è Business logic</span>
  <span class="string">"DownloadId"</span>: 0,                 <span class="comment">// üîó Internal system IDs</span>
  <span class="string">"ProductTemplateId"</span>: 0,          <span class="comment">// üé® Template IDs</span>
  <span class="string">"DeliveryDateId"</span>: 0,             <span class="comment">// üìÖ Delivery configuration</span>
  <span class="string">"LowStockActivityId"</span>: 0,         <span class="comment">// ‚ö†Ô∏è Alert configuration</span>
  <span class="string">"BackorderModeId"</span>: 0,            <span class="comment">// üìã Order mode</span>
  <span class="string">"RecurringCyclePeriodId"</span>: 0      <span class="comment">// üîÑ Subscription config</span>
}</div>
                
                <div class="impact-box">
                    <h4>Impact</h4>
                    <ul>
                        <li><strong>Industrial espionage:</strong> Competitors can see costs and calculate exact margins</li>
                        <li><strong>Inventory intelligence:</strong> Access to real-time stock by warehouse</li>
                        <li><strong>System reconnaissance:</strong> Complete database schema mapping</li>
                        <li><strong>Targeted attacks:</strong> Information to exploit other vulnerabilities</li>
                    </ul>
                </div>
                
                <h4>Proof of Concept</h4>
                <div class="code-block">curl <span class="string">"https://lcom-nextjsapp.happymeadow-56d1104c.centralus.azurecontainerapps.io/api/products/1966"</span>
<span class="comment"># Returns 2,100+ lines of JSON with complete product data</span></div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <p>Implement DTO (Data Transfer Object) - Only expose necessary fields:</p>
                    <div class="code-block">{
  <span class="string">"Id"</span>: 1966,
  <span class="string">"Name"</span>: <span class="string">"Lightmeter Model CA811"</span>,
  <span class="string">"Sku"</span>: <span class="string">"AEMC-CA811"</span>,
  <span class="string">"Price"</span>: <span class="string">"165.99"</span>,
  <span class="string">"ShortDescription"</span>: <span class="string">"..."</span>,
  <span class="string">"StockAvailability"</span>: <span class="string">"In Stock"</span>  <span class="comment">// Boolean, not exact quantity</span>
}</div>
                </div>
            </div>
            
            <div class="vuln-box critical">
                <div class="vuln-header">
                    <h3>SEC-002: IDOR - Insecure Direct Object Reference</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-critical">CRITICAL</span>
                        <span class="badge badge-p0">P0</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 8.1 (High) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>The API allows access to any product by simply incrementing the numeric ID, without permission validation or authentication. This enables massive scraping of the entire product database.</p>
                
                <h4>Proof of Concept</h4>
                <div class="code-block"><span class="comment"># Sequential access without restrictions</span>
<span class="keyword">for</span> id <span class="keyword">in</span> 1 2 3 100 1000 2000 9999; <span class="keyword">do</span>
  curl <span class="string">"https://.../api/products/<span class="keyword">$id</span>"</span>
<span class="keyword">done</span>
<span class="comment"># All return HTTP 200 with complete data</span></div>
                
                <div class="impact-box">
                    <h4>Impact</h4>
                    <ul>
                        <li>Massive scraping of complete catalog (~3,900 products)</li>
                        <li>Exposure of sensitive data from all products</li>
                        <li>Possible enumeration of unpublished or discontinued products</li>
                    </ul>
                </div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <ol>
                        <li>Implement rate limiting by IP/user</li>
                        <li>Require authentication for detailed API access</li>
                        <li>Use UUIDs instead of sequential IDs</li>
                        <li>Implement session/permission validation</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üü† HIGH Severity Vulnerabilities</h2>
            
            <div class="vuln-box high">
                <div class="vuln-header">
                    <h3>SEC-003: Cross-Site Scripting (XSS) Reflected</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-high">HIGH</span>
                        <span class="badge badge-p1">P1</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 6.1 (Medium) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>The search parameter on the products page reflects user input without sanitization, allowing execution of malicious JavaScript code.</p>
                
                <h4>Confirmed Vectors</h4>
                <div class="code-block">https://.../products?search=&lt;script&gt;alert(1)&lt;/script&gt;
https://.../products?search=&lt;img src=x onerror=alert(1)&gt;
https://.../products?search=&lt;svg onload=alert(1)&gt;</div>
                
                <div class="impact-box">
                    <h4>Impact</h4>
                    <ul>
                        <li>Session cookie theft</li>
                        <li>Keylogging</li>
                        <li>Redirection to malicious sites</li>
                        <li>Website defacement</li>
                        <li>Phishing attacks</li>
                    </ul>
                </div>
                
                <h4>Proof of Concept</h4>
                <div class="code-block">curl -s <span class="string">"https://.../products?search=%3Cscript%3Ealert(1)%3C/script%3E"</span> | grep <span class="string">'&lt;script&gt;'</span>
<span class="comment"># Output: &lt;script&gt;alert(1)&lt;/script&gt; (reflected without encoding)</span></div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <div class="code-block"><span class="comment">// Sanitize input before rendering</span>
<span class="keyword">const</span> sanitizedSearch = DOMPurify.sanitize(userInput);
<span class="comment">// Or escape HTML entities</span>
<span class="keyword">const</span> escapedSearch = escapeHtml(userInput);</div>
                </div>
            </div>
            
            <div class="vuln-box high">
                <div class="vuln-header">
                    <h3>SEC-004: No Rate Limiting</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-high">HIGH</span>
                        <span class="badge badge-p1">P1</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 5.3 (Medium) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>The API does not implement rate limiting, allowing an unlimited number of requests from the same IP.</p>
                
                <h4>Proof of Concept</h4>
                <div class="code-block"><span class="comment"># 10 requests in less than 1 second - all successful</span>
<span class="keyword">for</span> i <span class="keyword">in</span> {1..10}; <span class="keyword">do</span>
  curl -s -o /dev/null -w <span class="string">"%{http_code} "</span> \
    <span class="string">"https://.../api/products?page=<span class="keyword">$i</span>&limit=1"</span>
<span class="keyword">done</span>
<span class="comment"># Output: 200 200 200 200 200 200 200 200 200 200</span></div>
                
                <div class="impact-box">
                    <h4>Impact</h4>
                    <ul>
                        <li>Brute force attacks</li>
                        <li>Massive scraping without restrictions</li>
                        <li>Denial of Service (DoS) by resource exhaustion</li>
                        <li>Massive data enumeration</li>
                    </ul>
                </div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <div class="code-block"><span class="comment">// Implement rate limiting (example with express-rate-limit)</span>
<span class="keyword">const</span> rateLimit = require(<span class="string">'express-rate-limit'</span>);
<span class="keyword">const</span> limiter = rateLimit({
  windowMs: 15 * 60 * 1000, <span class="comment">// 15 minutes</span>
  max: 100 <span class="comment">// max 100 requests per IP</span>
});
app.use(<span class="string">'/api/'</span>, limiter);</div>
                </div>
            </div>
            
            <div class="vuln-box high">
                <div class="vuln-header">
                    <h3>SEC-005: Missing Security Headers</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-high">HIGH</span>
                        <span class="badge badge-p1">P1</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 5.0 (Medium) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>The server does not include essential security headers, leaving the application vulnerable to various attacks.</p>
                
                <h4>Missing Headers</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Header</th>
                            <th>Purpose</th>
                            <th>Risk without it</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>X-Content-Type-Options: nosniff</code></td>
                            <td>Prevent MIME sniffing</td>
                            <td>Malicious code execution</td>
                        </tr>
                        <tr>
                            <td><code>X-Frame-Options: DENY</code></td>
                            <td>Prevent clickjacking</td>
                            <td>UI redressing attacks</td>
                        </tr>
                        <tr>
                            <td><code>Strict-Transport-Security</code></td>
                            <td>Force HTTPS</td>
                            <td>Downgrade attacks</td>
                        </tr>
                        <tr>
                            <td><code>Content-Security-Policy</code></td>
                            <td>Control loaded resources</td>
                            <td>XSS, data injection</td>
                        </tr>
                        <tr>
                            <td><code>X-XSS-Protection</code></td>
                            <td>Additional XSS protection</td>
                            <td>XSS in legacy browsers</td>
                        </tr>
                        <tr>
                            <td><code>Referrer-Policy</code></td>
                            <td>Control referrer information</td>
                            <td>Information leakage</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Current Headers (Insecure)</h4>
                <div class="code-block">HTTP/2 200
vary: rsc, next-router-state-tree, ...
x-nextjs-cache: HIT
x-nextjs-prerender: 1
x-powered-by: Next.js          <span class="comment">‚Üê Information Disclosure</span>
cache-control: s-maxage=31536000</div>
                
                <div class="impact-box">
                    <h4>Information Disclosure</h4>
                    <p><code>X-Powered-By: Next.js</code> reveals technology used, facilitating targeted attacks.</p>
                </div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <div class="code-block"><span class="comment">// next.config.js</span>
module.exports = {
  <span class="keyword">async</span> headers() {
    <span class="keyword">return</span> [
      {
        source: <span class="string">'/:path*'</span>,
        headers: [
          { key: <span class="string">'X-Content-Type-Options'</span>, value: <span class="string">'nosniff'</span> },
          { key: <span class="string">'X-Frame-Options'</span>, value: <span class="string">'DENY'</span> },
          { key: <span class="string">'Strict-Transport-Security'</span>, value: <span class="string">'max-age=63072000; includeSubDomains; preload'</span> },
          { key: <span class="string">'Content-Security-Policy'</span>, value: <span class="string">"default-src 'self'"</span> },
          { key: <span class="string">'X-XSS-Protection'</span>, value: <span class="string">'1; mode=block'</span> },
          { key: <span class="string">'Referrer-Policy'</span>, value: <span class="string">'strict-origin-when-cross-origin'</span> },
          { key: <span class="string">'X-Powered-By'</span>, value: <span class="string">''</span> }  <span class="comment">// Remove information disclosure</span>
        ]
      }
    ];
  }
};</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üü° MEDIUM Severity Vulnerabilities</h2>
            
            <div class="vuln-box medium">
                <div class="vuln-header">
                    <h3>SEC-006: Error Information Disclosure</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-medium">MEDIUM</span>
                        <span class="badge badge-p2">P2</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 4.3 (Medium) | <strong>Status:</strong> Open (requires more testing)</p>
                
                <h4>Description</h4>
                <p>API errors could expose internal stack trace information. Requires more testing to confirm exact scope.</p>
                
                <div class="impact-box">
                    <h4>Note</h4>
                    <p>The <code>/api/newsletter</code> endpoint returns generic errors, but other endpoints might be more verbose.</p>
                </div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <ol>
                        <li>Implement global error handling</li>
                        <li>Don't expose stack traces to client</li>
                        <li>Log detailed errors only on server</li>
                    </ol>
                </div>
            </div>
            
            <div class="vuln-box medium">
                <div class="vuln-header">
                    <h3>SEC-007: SEO Files Misconfigured</h3>
                    <div class="vuln-meta">
                        <span class="badge badge-medium">MEDIUM</span>
                        <span class="badge badge-p3">P3</span>
                    </div>
                </div>
                
                <p><strong>CVSS:</strong> 2.0 (Low) | <strong>Status:</strong> Open</p>
                
                <h4>Description</h4>
                <p>The <code>robots.txt</code> and <code>sitemap.xml</code> files do not exist or return HTML instead of the correct format, affecting SEO and possibly revealing server behavior.</p>
                
                <h4>Current Behavior</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Request</th>
                            <th>Response</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>GET /robots.txt</code></td>
                            <td>HTTP 200 with main page HTML</td>
                            <td>‚ùå Incorrect</td>
                        </tr>
                        <tr>
                            <td><code>GET /sitemap.xml</code></td>
                            <td>HTTP 200 with main page HTML</td>
                            <td>‚ùå Incorrect</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="impact-box">
                    <h4>Impact</h4>
                    <ul>
                        <li>SEO negatively affected</li>
                        <li>Crawlers cannot index correctly</li>
                        <li>Unexpected server behavior</li>
                    </ul>
                </div>
                
                <div class="remediation-box">
                    <h4>Remediation</h4>
                    <p><strong>1. Create <code>public/robots.txt</code> file:</strong></p>
                    <div class="code-block">User-agent: *
Allow: /
Sitemap: https://.../sitemap.xml</div>
                    <p><strong>2. Create <code>public/sitemap.xml</code> or generate dynamically</strong></p>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üìä Vulnerability Summary</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Vulnerability</th>
                        <th>Severity</th>
                        <th>CVSS</th>
                        <th>Priority</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SEC-001</td>
                        <td>Data Exposure (API)</td>
                        <td><span class="badge badge-critical">CRITICAL</span></td>
                        <td>7.5</td>
                        <td><span class="badge badge-p0">P0</span></td>
                    </tr>
                    <tr>
                        <td>SEC-002</td>
                        <td>IDOR</td>
                        <td><span class="badge badge-critical">CRITICAL</span></td>
                        <td>8.1</td>
                        <td><span class="badge badge-p0">P0</span></td>
                    </tr>
                    <tr>
                        <td>SEC-003</td>
                        <td>Reflected XSS</td>
                        <td><span class="badge badge-high">HIGH</span></td>
                        <td>6.1</td>
                        <td><span class="badge badge-p1">P1</span></td>
                    </tr>
                    <tr>
                        <td>SEC-004</td>
                        <td>No Rate Limiting</td>
                        <td><span class="badge badge-high">HIGH</span></td>
                        <td>5.3</td>
                        <td><span class="badge badge-p1">P1</span></td>
                    </tr>
                    <tr>
                        <td>SEC-005</td>
                        <td>Missing Headers</td>
                        <td><span class="badge badge-high">HIGH</span></td>
                        <td>5.0</td>
                        <td><span class="badge badge-p1">P1</span></td>
                    </tr>
                    <tr>
                        <td>SEC-006</td>
                        <td>Error Info Disclosure</td>
                        <td><span class="badge badge-medium">MEDIUM</span></td>
                        <td>4.3</td>
                        <td><span class="badge badge-p2">P2</span></td>
                    </tr>
                    <tr>
                        <td>SEC-007</td>
                        <td>SEO Files Missing</td>
                        <td><span class="badge badge-medium">MEDIUM</span></td>
                        <td>2.0</td>
                        <td><span class="badge badge-p3">P3</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>üõ†Ô∏è Priority Recommendations</h2>
            
            <div class="priority-section">
                <h3>üî¥ Immediate (Before Launch)</h3>
                <ol>
                    <li><strong>SEC-001:</strong> Implement DTOs to sanitize API responses</li>
                    <li><strong>SEC-002:</strong> Add authentication and rate limiting to API</li>
                    <li><strong>SEC-003:</strong> Sanitize all user inputs (XSS protection)</li>
                </ol>
            </div>
            
            <div class="priority-section" style="background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);">
                <h3>üü† This Week</h3>
                <ol>
                    <li><strong>SEC-004:</strong> Implement global rate limiting</li>
                    <li><strong>SEC-005:</strong> Configure security headers in Next.js</li>
                    <li><strong>SEC-006:</strong> Review and improve error handling</li>
                </ol>
            </div>
            
            <div class="priority-section" style="background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);">
                <h3>üü° Next Sprint</h3>
                <ol>
                    <li><strong>SEC-007:</strong> Create proper robots.txt and sitemap.xml files</li>
                    <li>Conduct additional pentest with specialized tools (OWASP ZAP, Burp Suite)</li>
                    <li>Implement security monitoring and logging</li>
                </ol>
            </div>
        </div>
        
        <div class="section">
            <h2>üß™ Testing Methodology</h2>
            
            <div class="methodology-grid">
                <div class="methodology-card">
                    <h4>Techniques Used</h4>
                    <ul>
                        <li>Passive reconnaissance (headers, common files)</li>
                        <li>IDOR testing (direct object access)</li>
                        <li>XSS testing (reflected and stored)</li>
                        <li>Data exposure testing (API fields)</li>
                        <li>Rate limiting verification</li>
                        <li>Security headers analysis</li>
                    </ul>
                </div>
                
                <div class="methodology-card">
                    <h4>Tools</h4>
                    <ul>
                        <li>curl (manual API testing)</li>
                        <li>web_fetch (content analysis)</li>
                        <li>Manual HTTP header analysis</li>
                    </ul>
                </div>
                
                <div class="methodology-card">
                    <h4>Limitations</h4>
                    <ul>
                        <li>No automated SQL Injection tests (requires more time)</li>
                        <li>No CSRF vectors tested (requires authentication)</li>
                        <li>No endpoint fuzzing (additional tools needed)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>üìû Remediation Contact</h2>
            <p>For questions about remediating these vulnerabilities:</p>
            <ol>
                <li>Review OWASP documentation for each vulnerability</li>
                <li>Consider hiring an additional professional pentest</li>
                <li>Implement CI/CD with automatic security scanning</li>
            </ol>
        </div>
        
        <div class="footer">
            <p>üîí Confidential Security Report | February 5, 2026</p>
            <p><strong>Conducted by:</strong> Andres & Clawd ü§ù</p>
            <p>This document contains sensitive security information. Distribution restricted.</p>
            <p><em>End of Security Report</em></p>
        </div>
    </div>
    
    <script>
        const VALID_USERNAME = 'admin';
        const VALID_PASSWORD = 'audit2026';
        
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            
            if (username === VALID_USERNAME && password === VALID_PASSWORD) {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('reportContent').style.display = 'block';
                document.body.style.background = '#f5f7fa';
                errorMsg.style.display = 'none';
            } else {
                errorMsg.style.display = 'block';
                document.getElementById('password').value = '';
            }
        }
        
        function logout() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('reportContent').style.display = 'none';
            document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }
        
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });
    </script>
</body>
</html>
